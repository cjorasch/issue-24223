/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */
import{b as t,c as n}from"./p-6cc127f3.js";import{OVERLAY_BACK_BUTTON_PRIORITY as o}from"./p-0b7fe16d.js";import{c as e,f as a,a as i,b as s,g as r}from"./p-dc344987.js";let c=0;const d=new WeakMap,u=t=>({create:n=>x(t,n),dismiss:(n,o,e)=>P(document,n,o,t,e),getTop:async()=>A(document,t)}),l=u("ion-alert"),p=u("ion-action-sheet"),m=u("ion-loading"),f=u("ion-modal"),v=u("ion-picker"),y=u("ion-popover"),b=u("ion-toast"),h=t=>{"undefined"!=typeof document&&O(document);const n=c++;t.overlayIndex=n,t.hasAttribute("id")||(t.id=`ion-overlay-${n}`)},x=(t,n)=>"undefined"!=typeof customElements?customElements.whenDefined(t).then((()=>{const o=document.createElement(t);return o.classList.add("overlay-hidden"),Object.assign(o,Object.assign({},n)),G(document).appendChild(o),new Promise((t=>e(o,t)))})):Promise.resolve(),w='[tabindex]:not([tabindex^="-"]), input:not([type=hidden]):not([tabindex^="-"]), textarea:not([tabindex^="-"]), button:not([tabindex^="-"]), select:not([tabindex^="-"]), .ion-focusable:not([tabindex^="-"])',g="input:not([type=hidden]), textarea, button, select",j=(t,n)=>{let o=t.querySelector(w);const e=o&&o.shadowRoot;e&&(o=e.querySelector(g)||o),o?a(o):n.focus()},k=(t,n)=>{const o=Array.from(t.querySelectorAll(w));let e=o.length>0?o[o.length-1]:null;const a=e&&e.shadowRoot;a&&(e=a.querySelector(g)||e),e?e.focus():n.focus()},O=t=>{0===c&&(c=1,t.addEventListener("focus",(n=>((t,n)=>{const o=A(n),e=t.target;o&&e&&(o.shadowRoot?(()=>{if(o.contains(e))o.lastFocus=e;else{const t=o.lastFocus;j(o,o),t===n.activeElement&&k(o,o),o.lastFocus=n.activeElement}})():(()=>{if(o===e)o.lastFocus=void 0;else{const t=r(o);if(!t.contains(e))return;const a=t.querySelector(".ion-overlay-wrapper");if(!a)return;if(a.contains(e))o.lastFocus=e;else{const t=o.lastFocus;j(a,o),t===n.activeElement&&k(a,o),o.lastFocus=n.activeElement}}})())})(n,t)),!0),t.addEventListener("ionBackButton",(n=>{const e=A(t);e&&e.backdropDismiss&&n.detail.register(o,(()=>e.dismiss(void 0,_)))})),t.addEventListener("keyup",(n=>{if("Escape"===n.key){const n=A(t);n&&n.backdropDismiss&&n.dismiss(void 0,_)}})))},P=(t,n,o,e,a)=>{const i=A(t,e,a);return i?i.dismiss(n,o):Promise.reject("overlay does not exist")},A=(t,n,o)=>{const e=((t,n)=>(void 0===n&&(n="ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover,ion-toast"),Array.from(t.querySelectorAll(n)).filter((t=>t.overlayIndex>0))))(t,n);return void 0===o?e[e.length-1]:e.find((t=>t.id===o))},B=(t=!1)=>{const n=G(document).querySelector("ion-router-outlet, ion-nav, #ion-view-container-root");n&&(t?n.setAttribute("aria-hidden","true"):n.removeAttribute("aria-hidden"))},E=async(o,e,a,i,s)=>{var r,c;if(o.presented)return;B(!0),o.presented=!0,o.willPresent.emit(),null===(r=o.willPresentShorthand)||void 0===r||r.emit();const d=t(o),u=o.enterAnimation?o.enterAnimation:n.get(e,"ios"===d?a:i);await I(o,u,o.el,s)&&(o.didPresent.emit(),null===(c=o.didPresentShorthand)||void 0===c||c.emit()),"ION-TOAST"!==o.el.tagName&&T(o.el),o.keyboardClose&&o.el.focus()},T=async t=>{let n=document.activeElement;if(!n)return;const o=n&&n.shadowRoot;o&&(n=o.querySelector(g)||n),await t.onDidDismiss(),n.focus()},z=async(o,e,a,i,s,r,c)=>{var u,l;if(!o.presented)return!1;B(!1),o.presented=!1;try{o.el.style.setProperty("pointer-events","none"),o.willDismiss.emit({data:e,role:a}),null===(u=o.willDismissShorthand)||void 0===u||u.emit({data:e,role:a});const p=t(o),m=o.leaveAnimation?o.leaveAnimation:n.get(i,"ios"===p?s:r);"gesture"!==a&&await I(o,m,o.el,c),o.didDismiss.emit({data:e,role:a}),null===(l=o.didDismissShorthand)||void 0===l||l.emit({data:e,role:a}),d.delete(o),o.el.classList.add("overlay-hidden")}catch(t){console.error(t)}return o.el.remove(),!0},G=t=>t.querySelector("ion-app")||t.body,I=async(t,o,e,a)=>{e.classList.remove("overlay-hidden");const i=o(t.el,a);t.animated&&n.getBoolean("animated",!0)||i.duration(0),t.keyboardClose&&i.beforeAddWrite((()=>{const t=e.ownerDocument.activeElement;t&&t.matches("input,ion-input, ion-textarea")&&t.blur()}));const s=d.get(t)||[];return d.set(t,[...s,i]),await i.play(),!0},M=(t,n)=>{let o;const e=new Promise((t=>o=t));return N(t,n,(t=>{o(t.detail)})),e},N=(t,n,o)=>{const e=a=>{s(t,n,e),o(a)};i(t,n,e)},S=t=>"cancel"===t||t===_,W=t=>t(),$=(t,o)=>{if("function"==typeof t)return n.get("_zoneGate",W)((()=>{try{return t(o)}catch(t){throw t}}))},_="backdrop";export{_ as B,l as a,p as b,y as c,E as d,h as e,z as f,M as g,d as h,S as i,j,m as l,f as m,v as p,$ as s,b as t}